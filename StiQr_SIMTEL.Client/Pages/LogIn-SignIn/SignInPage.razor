@page "/siginPage"
@using StiQR_SIMTEL.Services
@using StiQr_SIMTEL.Shared

@inject IUserService UserService;
<img class="imgbackground" src="/img/background.png" alt="background" />
<div class="login">
    
    <div>
        <div class="logo">
            
            <div class="textContainer">
                <p class="title">Registro</p>
                <p class="subtitle">Crea una nueva cuenta</p>
            </div>
        </div>
        <div class="formContainer">
            <form>
                <div class="form-group">
                    <label for="name">Nombre</label>
                    <input @bind="name" type="text" id="name" name="name" required />
                </div>
                <div class="form-group">
                    <label for="name">Apellido</label>
                    <input @bind="lastname" type="text" id="lastname" name="lastname" required />
                </div>
                <div class="form-group">
                    <label for="name">Cédula</label>
                    <input @bind="cidentity" type="text" id="cidentity" name="cidentity" required />
                </div>
                <div class="form-group">
                    <label for="email">Email</label>
                    <input @bind="email" type="email" id="email" name="email" required />
                </div>
                <div class="form-group">
                    <label for="phone">Celular</label>
                    <input @bind="phone" type="number" id="phone" name="celuar" pattern="[0-9]*" inputmode="numeric" oninput="validarNumero(event)" required />
                </div>
                <div class="form-group">
                    <label for="password">Contraseña:</label>
                    <input @bind="password" type="password" id="password" name="password" required />
                </div>
               
                <button @onclick="CreateuserDetails" type="submit">Registrarse</button>
            </form>
            <div class="sign-up">
              ¿Ya tienes una cuenta? <a href="/loginPage">Ingresa</a>
            </div>
        </div>
    
    </div>
   
</div>
    

@code {
    private string name;
    private string lastname;
    private string cidentity;
    private string email;
    private string phone;
    private string password;
    private async void CreateuserDetails()
    {
        var createUserRequest = new UserDTO
            {
                Name = name,
                LastName = lastname,
                Cidentity = cidentity,
                Email=email,
                Phone=phone,
                Password=password
        };
        var response= await UserService.CreateUser(createUserRequest);
        if (response.IsSuccess)
        {
            name = lastname = cidentity = email = phone = password = string.Empty;
            this.StateHasChanged();
            await App.Current.MainPage.DisplayAlert("Usuario añadido", "Usuario creado correctamente", "OK");
        }
        else
        {
            await App.Current.MainPage.DisplayAlert("Oops", response.ErrorMessage, "OK");
        }
    }
}
